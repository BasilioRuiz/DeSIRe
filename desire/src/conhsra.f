C CONHSRA construida con el programa CONTINUO
C calcula el continuo del HSRA por medio de un ajuste a un polinomio
c de tercer grado.El error maximo es de .125%

	real*4 function conhsra(x)

	implicit real*4 (a-h,o-z)
	real*8 cdoble, conhsra3
	real*4 c1(11),c2(11),c3(11),c4(11),c5(11),c6(11),c7(11)
	data c1/-4.906054765549e13,1.684734544039e11,1.507254517567e7
     &       ,-7561.242976546,0.,0.,0.,0.,0.,0.,0./
	data c2/-4.4650822755e14,6.1319780351059e11,-9.350928003805e7
     &       ,0.,0.,0.,0.,0.,0.,0.,0./
	data c3/-1.025961e15,1.3172859e12,-3.873465e8
     &       ,46486.541,-2.049,0.,0.,0.,0.,0.,0./
	data c4/4.861821e15,-2.2589885e12,4.3764376e8
     &       ,-39279.61444,1.34388,0.,0.,0.,0.,0.,0./
c	data c5/4.353082e17,-1.261996e14,5.31125e9,908890.899,43.24361
c     &       7,-2.0462285d-2,1.0018226758d-6,0.,0.,0.,0./
	data c5/1.758394e15,-3.293986e11,1.6782617e7,0.,0.,0.
     &       ,0.,0.,0.,0.,0./
	data c6/1.61455557e16,-6.544209e12,1.0159316e9
     &       ,-70695.58136,1.852022,0.,0.,0.,0.,0.,0./
	data c7/7.97805136e14,-1.16906597e11,5.315222e6
     &       ,-4.57327954,-3.473452e-3,0.,0.,0.,0.,0.,0./

	if(x.lt.3644.15)then
	    conhsra=c1(1)+x*(c1(2)+x*(c1(3)+x*(c1(4)+x*c1(5))))
	else if(x.lt.3750.)then
	    conhsra=c2(1)+x*(c2(2)+x*(c2(3)+x*(c2(4)+x*c2(5))))
	else if(x.lt.6250.)then
	    conhsra=c3(1)+x*(c3(2)+x*(c3(3)+x*(c3(4)+x*c3(5))))
	else if(x.lt.8300.)then
	    conhsra=c4(1)+x*(c4(2)+x*(c4(3)+x*(c4(4)+x*c4(5))))
	else if(x.lt.8850.)then
	    conhsra=c5(1)+x*(c5(2)+x*(c5(3)+x*(c5(4)+x*c5(5))))
	else if(x.lt.10000.)then
	    conhsra=c6(1)+x*(c6(2)+x*(c6(3)+x*(c6(4)+x*c6(5))))
	else if(x.lt.11000.)then
	    conhsra=c7(1)+x*(c7(2)+x*(c7(3)+x*(c7(4)+x*c7(5))))
	else 
	    cdoble=conhsra3(x)
	    conhsra=real(cdoble)
	end if
	return
	end
c------------------------------------------------------------------	
	real*8 function conhsra3(x)
	
	implicit real*8 (a-h,o-z)
	real*8 par(9,38),xx
	integer in
	real*4 x

	data par/11000.000,  1000.,30.000,
     *  3.48289590000,  0.29332542000, -0.07935836900,
     *  0.00503848490, -0.00010911067,  0.00000000000,
     * 14202.000, 14000.,31.633,
     *  2.25191360000, -2.21467000000,  0.00000000000,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     * 14250.000,  1000.,30.000,
     *  4.05227510000, -0.18186949000,  0.00083747599,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     * 14500.000, 14000.,31.580,
     *  2.29667760000, -2.20662120000,  0.00000000000,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     * 14577.000, 14000.,31.580,
     *  2.25306270000, -2.15553600000,  0.00000000000,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     * 14600.000,  1000.,30.000,
     * 16.03850900000, -2.65102180000,  0.17030757000,
     * -0.00387231810,  0.00000000000,  0.00000000000,
     * 16350.000, 16000.,31.280,
     * -2.28171060000,  7.49794770000, -5.13656810000,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     * 16419.000, 16000.,31.280,
     *  5.05769590000, -6.35307310000,  1.39139250000,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     * 16450.000,  1000.,30.000,
     *  7.28134070000, -0.58288516000,  0.01843680200,
     * -0.00036871446,  0.00000322391,  0.00000000000,
     * 22750.000, 22800.,30.080,
     *  2.00744630000,  2.28869630000, -6.85888670000,
     *  2.55955890000,  0.00000000000,  0.00000000000,
     * 22776.300, 22800.,30.080,
     *  3.75657130000, -3.75614760000,  0.00000000000,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     * 22800.000,  1000.,30.000,
     *  6.81529490000, -0.49897589000,  0.01284022100,
     * -0.00020295009,  0.00000137788,  0.00000000000,
     * 30000.100, 30000.,29.035,
     * 18.25140400000,-32.63397200000, 14.38775600000,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     * 30049.999, 10000.,30.000,
     *  4.54297950000, -2.39115090000,  0.18562412000,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     * 32750.100, 30000.,28.700,
     *  1.99525650000,  1.98310880000, -5.41611870000,
     *  1.76582060000,  0.00000000000,  0.00000000000,
     * 32797.900, 30000.,28.700,
     *  3.84567890000, -3.51942910000,  0.00000000000,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     * 32799.999, 10000.,30.000,
     *  5.89277940000, -3.80810240000,  0.71566516000,
     * -0.08079618200,  0.00386408250,  0.00000000000,
     * 44600.102, 44600.,27.503,
     *  3.90163030000, -3.89929090000,  0.00000000000,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     * 44641.602, 44600.,27.503,
     *  3.90056690000, -3.89805030000,  0.00000000000,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     * 44650.002, 10000.,30.000,
     *  4.94129750000, -2.94726560000,  0.42248154000,
     * -0.03623551100,  0.00131391830,  0.00000000000,
     * 58300.000, 58300.,26.454,
     *  3.93593910000, -3.93388820000,  0.00000000000,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     * 58307.398, 58300.,26.454,
     *  3.93347080000, -3.93137290000,  0.00000000000,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     * 58349.998, 10000.,30.000,
     *  2.21776400000, -1.30221860000,  0.05384883800,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     * 60950.000,100000.,25.000,
     *  8.96353530000,-22.78659100000, 25.02728300000,
     *-16.43597400000,  4.56634520000,  0.00000000000,
     * 73700.000, 73800.,25.525,
     *  3.95955200000, -3.95845240000,  0.00000000000,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     * 73795.398, 73800.,25.525,
     *  3.95587060000, -3.95475520000,  0.00000000000,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     * 73850.000,100000.,25.000,
     *  8.21656920000,-18.74957000000, 16.82743300000,
     * -9.01723430000,  2.04365850000,  0.00000000000,
     * 91100.000, 91100.,24.690,
     *  3.97991420000, -3.97871510000,  0.00000000000,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     * 91105.203, 91100.,24.690,
     *  3.97225200000, -3.97104770000,  0.00000000000,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     * 91150.000,100000.,25.000,
     *  6.51536360000,-11.66027200000,  5.71484220000,
     * -1.24929570000,  0.00000000000,  0.00000000000,
     *110900.000,100000.,20.000,
     * 10.82845200000, -9.79083090000,  4.01636330000,
     * -0.73414296000,  0.00000000000,  0.00000000000,
     *131150.000,131150.,23.239,
     *  3.99058200000, -3.98961510000,  0.00000000000,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     *131191.500,131150.,23.239,
     *  3.98348100000, -3.98247530000,  0.00000000000,
     *  0.00000000000,  0.00000000000,  0.00000000000,
     *131200.000,100000.,20.000,
     * 10.11379400000, -8.16836280000,  2.78664550000,
     * -0.42295997000,  0.00000000000,  0.00000000000,
     *160850.000,100000.,20.000,
     *  9.18797430000, -6.46577580000,  1.74014520000,
     * -0.20796399000,  0.00000000000,  0.00000000000,
     *210800.000,100000.,20.000,
     *  8.23869270000, -5.09763050000,  1.08111920000,
     * -0.10187501000,  0.00000000000,  0.00000000000,
     *260750.000,100000.,20.000,
     *  7.47090580000, -4.20699500000,  0.73613949000,
     * -0.05725740900,  0.00000000000,  0.00000000000,
     *310700.000,100000.,20.000,
     *  6.97130390000, -3.90560230000,  0.74610918000,
     * -0.09322419700,  0.00642548360, -0.00018543588/
	
	in=1
	do while(x .gt. par(1,in) .and. in .lt. 38)
	   in=in+1
	enddo
	if(x .le. par(1,in))in=in-1
		
	xx=x/par(2,in)
	yy=par(4,in)+xx*(par(5,in)+xx*(par(6,in)+xx*(par(7,in)
     &	                       +xx*(par(8,in)+xx*par(9,in)))))
     
	
	yyoff=yy+par(3,in)
	if(yyoff .gt. 88.7d0)yyoff=88.7d0
	if(yyoff .lt. -87.3d0)yyoff=-87.3d0
	conhsra3=exp(yyoff)
	
	return
	end
c------------------------------------------------------------------		
	real*8 function conhsra_RH(x)
	
	implicit real*8 (a-h,o-z)
        include 'PARAMETER'
	real*8 xx,yn
	real*4 x

        if(x .lt. 1700.)then
            call error(KWARN,'conhsra_RH',
     &                 'Please, revise continuum calibration')
        else if(x .le. 1724)then	!CORRECTED
            xx=x*1.d0-2.d3
            yn=-0.035332881+xx*(-0.00025832630+xx*(-4.5882973e-07))
        else if(x .lt. 1748.)then       !CORRECTED
            xx=x*1.d0-2.d3
            yn=0.0012226732+xx*(-4.1009889e-06+xx*(-1.7652324e-08))
        else if(x .lt. 1773)then        !CORRECTED
            xx=x*1.d0-2.d3
            yn=2.2889557+xx*(0.014821529+xx*(1.9671395e-05+xx*(
     &        1.1030352e-08+xx*9.2477137e-11)))
        else if(x .lt. 1801)then        !CORRECTED
            xx=x*1.d0-2.d3
            yn=3.1054206+xx*(0.051036503+xx*(0.00027907122+xx*(
     &         4.9959647e-07)))
        else if(x .lt. 1924.)then         !CORRECTED
            xx=x*1.d0-2.d3
            yn=0.075251065+xx*(0.00057566963+xx*(9.2861928e-06+xx*(
     &         5.0962594e-08+xx*8.7795743e-11)))
        else if(x .lt. 1975.)then          !CORRECTED
            xx=x*1.d0-2.d3
            yn=-0.69388032+xx*(-0.11040923+xx*(-0.0063353637+xx*(
     &         -0.00018919008+xx*(-3.0830772e-06+xx*(-2.5896153e-08+xx*(
     &         -8.7663071e-11))))))
        else if(x .lt. 2024.)then          !CORRECTED
            xx=x*1.d0-2.d3
            yn=0.17926614+xx*(0.0034334555+xx*(-0.00013716691+xx*(
     &         -2.8433988e-06+xx*(2.9453511e-07+xx*(1.6925773e-09+xx*(
     &         -2.5088567e-10))))))
        else if(x .lt. 2176.)then          !CORRECTED
            xx=x*1.d0-2.d3
            yn=0.17627952+xx*(0.0013955882+xx*(-1.2945690e-05+xx*(
     &            3.2658306e-07+xx*(-3.9667341e-09+xx*(1.9751098e-11+xx*(
     &           -3.5026591e-14))))))
        else if(x .lt. 2215.)then          !CORRECTED
            xx=x*1.d0-2.d3
            yn=2.7019243+xx*(-0.037414949+xx*(0.00018991988+xx*(
     &         -3.1362353e-07)))
        else if(x .lt. 2267.0)then         !CORRECTED
        
        
        else if(x .lt. 3500.0)then
           xx=x*1.d0-2600.d0
           yn=0.38873023+xx*(0.0010986868+xx*(4.2044376e-06+xx*4.9204782e-09))        
        else if(x .lt. 2333.)then          !CORRECTED
           xx=x*1.d0-2600.d0
           yn= 2.0723810+xx*(0.023599669+xx*(0.00011752715+xx*(
     &         2.5610558e-07+xx*2.0700525e-10)))
        else if(x .lt. 2485.)then          !CORRECTED
           xx=x*1.d0-2600.d0
           yn=0.27536821+xx*(-0.00023446418+xx*(-1.0180214e-07))
        else if(x .lt. 2661)then          !CORRECTED
           xx=x*1.d0-2600.d0
           yn=0.91807204+xx*(0.00016716176+xx*(-4.1248023e-07))
        else if(x .lt. 2730.)then          !CORRECTED
           xx=x*1.d0-2600.d0
           yn=0.92258847+xx*(0.00018184002+xx*(-3.9604612e-07))
        
        else if(x .lt. 3065.)then          !CORRECTED
           xx=x*1.d0-2600.d0
           yn=0.37800357+xx*(0.013362123+xx*(-0.00012401355+xx*(
     &        5.8372308e-07+xx*(-1.4741059e-09+xx*(1.9068176e-12+xx*(
     &        -9.9401254e-16)))))) 
     
     
        else if(x .lt. 3356.)then  !NEW           
           xx=x*1.d0-3300.d0
           yn=1.0021864+xx*(-9.8864890e-05+xx*(2.0610242e-08+xx*(
     &      2.5454810e-10)))

       else if(x .lt. 3495.)then  !NEW 
           xx=x*1.d0-3300.d0
           yn=1.0122648+xx*(-0.00054718798+xx*(8.8353918e-06+xx*(
     &      -8.1447318e-08+xx*(3.5694739e-10+xx*(-5.9127226e-13)))))
     
      else if(x .lt. 3542.)then  !NEW 
           xx=x*1.d0-3300.d0
           yn=1.0034305+xx*(-8.8997534e-05+xx*7.0775194e-08)
    
        else if(x .lt. 3645.0)then  !NEW  
           xx=x*1.d0-3500.d0
           yn=0.98708731+xx*(-2.8175449e-05+xx*(8.4806636e-08+xx*(
     &       1.7099233e-11)))
     
       else if(x .lt. 3733.0)then  !NEW  
           xx=x*1.d0-3500.d0
           yn=0.94867164+xx*(-8.6623004e-08+xx*(6.8148651e-09+xx*(
     &        1.7523882e-10)))
                      
        else if(x .lt. 3749.)then  !NEW
           xx=x*1.d0-3500.d0
           yn=0.93908721+xx*(7.0798225e-05+xx*(-7.5924930e-08))
           
        else if(x .lt. 4100.)then  !NEW
           xx=x*1.d0-4000.
           yn=1.0037047+xx*(3.3595759e-05+xx*(4.7024184e-08+xx*(
     &       -5.0879984e-11+xx*(-1.2460399e-12+xx*(-9.2670402e-15+xx*(
     &       -2.0314993e-17))))))
     
c        else if(x .lt. 4219.)then  !NEW
c           xx=x*1.d0-4000.
c           yn=1.0148687+xx*(-0.00022289855+xx*(2.1870519e-06+xx*(
c     &        -8.2622975e-09+xx*(1.1118108e-11))))
c     
c     !<4250
c 
c     
c     
        else if(x .lt. 4850.)then  !NEW
           xx=x*1.d0-4000.d0
           yn=1.0366782+xx*(-0.00041082909+xx*(1.2430932e-06+xx*(
     &        -1.5510896e-09+xx*(8.6263754e-13+xx*(-1.6198539e-16+xx*(
     &        -1.0281490e-20))))))
        else if(x .lt. 5359.)then  !CORRECTED
           xx=x*1.d0-5000.d0
           yn=1.0094851+xx*(-1.3777479e-06+xx*(-1.3290397e-08+xx*(
     &    -2.5651845e-11+xx*(5.1445301e-13+xx*(-1.8107517e-15+xx*(
     &     2.0425949e-18))))))    
        else if(x .lt. 6846.)then  !CORRECTED 
           xx=x*1.d0-5000.d0
           yn=1.0258833+xx*(-0.00011999189+xx*(3.2961643e-07+xx*(
     &     -4.5958840e-10+xx*(3.3402339e-13+xx*(-1.2054827e-16+xx*(
     &      1.7055753e-20))))))        
        else if(x .lt. 8170.)then  !CORRECTED 
           xx=x*1.d0-7200.d0
           yn= 1.0053102+xx*(-2.9239147e-06+xx*(-8.0440203e-11+xx*(
     &       1.3008715e-12+xx*(-7.4627677e-15+xx*(-4.1093502e-18+xx*(
     &       9.8916011e-21+xx*(2.5445365e-24+xx*(-6.6244625e-27))))))))
        else if(x .lt. 8170.)then  !CORRECTED 
           xx=x*1.d0-7200.d0
           yn=105.37609+xx*(-0.40413117+xx*(0.00058536668+xx*(
     &       -3.7592446e-07+xx*9.0314124e-11)))
        else if(x .lt. 8850.)then  !CORRECTED 
           xx=x*1.d0-8350.d0
           yn=0.99815488+xx*(3.1356627e-05+xx*(-4.8872018e-08+xx*(
     &        -2.9436086e-11+xx*(2.0835542e-14+xx*(-1.1809234e-17)))))          
        else if(x .lt. 10006.)then   !CORRECTED 
           xx=x*1.d0-8350.d0
           yn= 0.99999958+xx*(-4.2364089e-05+xx*(1.8372089e-07+xx*(
     &        -3.2233971e-10+xx*(2.7623531e-13+xx*(-1.1565256e-16+xx*(
     &         1.8976674e-20))))))
        else if(x .lt. 11006.)then  !CORRECTED
           xx=(x*1.d0-10000.d0)/1000.d0
           yn=1.0001646+xx*(-0.0082457606+xx*(-0.0060950378+xx*(
     &           0.019933106+xx*(-0.014916684+xx*(0.0035784154)))))        
        else if(x .lt. 12998.)then !CORRECTED
           xx=(x*1.d0-11500.d0)/1000.d0
           yn=0.99358934+xx*(0.0017351075+xx*(-0.00045646506+xx*(
     &         -0.00022267233+xx*1.2431357e-07)))
        else if(x .lt. 14202)then !CORRECTED
           yn=0.994874
        else if(x .lt. 14398.)then !CORRECTED
           xx=(x*1.d0-14210.d0)/1000.d0
           yn=0.98895073+xx*(0.0017417363+xx*(0.012186378+xx*(
     &            -0.016341614+xx*(-0.00084253028))))         
        else if(x .lt. 14770.)then !CORRECTED
           xx=(x*1.d0-14210.d0)/1000.d0
           yn=0.98775971+xx*(-0.0024729017+xx*(0.012636206+xx*(
     &           -0.014982455+xx*(-0.0011333129))))

        else if(x .lt. 16422.)then    !CORRECTED
           xx=(x*1.d0-14210.d0)/1000.d0
           yn=0.95213360+xx*(0.19456612+xx*(-0.43548506+xx*(
     &        0.47825259+xx*(-0.27889577+xx*(0.081681490+xx*(
     &        -0.0094121434))))))
        else if(x .lt. 18231.)then   !CORRECTED
           xx=(x*1.d0-17000.)/1000.d0
           yn=0.97557265+xx*(0.0013027287+xx*0.00046011261)
        else if(x .lt. 22782.)then   !CORRECTED
           xx=(x*1.d0-20000.d0)/1000.d0
           yn=0.97784388+xx*(0.00093980588+xx*(0.00037547669+xx*(
     &       -0.00013939773+xx*(1.4541128e-05+xx*(1.9681496e-05+xx*(
     &       -4.1853764e-06))))))
        else if(x .lt. 23400.)then   !CORRECTED
           xx=(x*1.d0-20000.d0)/1000.d0
           yn=0.98759222+xx*(-0.0035465176+xx*0.00045682467)              
        else
           yn=1.d0
           call error(KWARN,'conhsra_RH',
     &                'Please, revise continuum calibration')
        end if   
	
	conhsra_RH=yn

        return
	end
c------------------------------------------------------------------		
	real*8 function conhsra_RHLTE(x)
	
	implicit real*8 (a-h,o-z)
        include 'PARAMETER'
	real*8 xx,yl
	real*4 x
	
	if(x .lt. 1700.)then
            call error(KWARN,'conhsra_RHLTE',
     &                 'Please, revise continuum calibration')
        else if (x .lt. 2513.5)then	!CORRECTED
            xx=x*1.d0-2.d3
            yl=0.37219930+xx*(0.00014417795+xx*(-6.8141446e-07+xx*(
     &        2.9592775e-10+xx*1.5969272e-13)))
        else if(x .lt. 3511.0)then!CORRECTED
           xx=x*1.d0-2600.d0
           yl=0.96446979+xx*(0.00016033911+xx*(
     &      -2.5846504e-07+xx*(1.6091468e-10+xx*(-2.8550289e-14))))
        else if(x .lt. 3644.15)then   !CORRECTED
           xx=x*1.d0-3500.d0
           yl=0.99799979+xx*(1.0499643e-06+xx*5.3058361e-08)
        else if(x .lt. 3749.)then   !CORRECTED
           xx=x*1.d0-3500.d0
           yl=1.0023624+xx*(-3.8107879e-05+xx*1.0129475e-07)
        else if(x .lt. 4200.)then !CORRECTED
           xx=x*1.d0-3750.d0
           yl=0.99370994488708675+xx*(0.00032756921427790076+xx*(
     &        -5.9371586758061312e-06+xx*(5.4234096324989878e-08+xx*(
     &        -2.7263453300507834e-10+xx*(7.6169650556519308e-13+xx*(
     &        -1.1052801373916745e-15+xx*6.4819206628392990e-19))))))
        else if(x .lt. 4550.)then !CORRECTED
           xx=x*1.d0-4200.d0
           yl=1.0007603638100022+xx*(-2.2535759309771919e-06+xx*(
     &        1.3629079635701924e-10+xx*2.2878550487751784e-12))
        else if(x .lt. 6250.)then  !CORRECTED
           xx=x*1.d0-5000.d0
           if(xx .lt. 350.)then    !CORRECTED
             yl=1.0001979262359555+xx*(-1.1946190703326920e-08+xx*(-5.2721033094726977e-09+xx*(
     &  8.2316564588985619e-11+xx*(-2.8663527172449743e-15+xx*(-2.4696418188435482e-15+xx*(
     &  2.1183438912871825e-18+xx*(3.0647559086869304e-20+xx*(-2.5192058438066792e-23+xx*(
     &  -1.7769518830253363e-25+xx*(8.5238701230555102e-29+xx*3.9937356504745098e-31))))))))))
           else
             yl=1.0003267619758844+xx*(-1.2656455510295928e-06+xx*(7.1420345193473622e-09+xx*(
     &   -1.8354262554254319e-11+xx*(1.8757077054759597e-14+xx*(-1.0119343802169516e-17+xx*(
     &   2.8334619518606473e-21))))))
           endif  
        else if(x .lt. 6549.)then  !CORRECTED
           xx=x*1.d0-7200.d0
           yl=0.99831337+xx*(1.5805413e-06+xx*(1.3337805e-08+xx*1.2058356e-11)) 
        else if(x .lt. 7234.)then  !CORRECTED
           xx=x*1.d0-7200.d0
           yl=0.99897325+xx*(-1.4943321e-06+xx*(4.4992197e-09+xx*(
     &     3.3326627e-13+xx*(-6.5170147e-15)))) 
        else if(x .lt. 7291.)then  !CORRECTED
           xx=x*1.d0-7200.d0
           yl=0.99957430+xx*(-2.0524942e-06)
        else if(x .lt. 8199.)then  !CORRECTED
           xx=x*1.d0-7200.d0
           yl=1.0008701+xx*(-1.7746041e-06+xx*(3.7640513e-09+xx*(
     &        5.7903682e-13+xx*(-2.0379206e-15+xx*(-7.2375590e-18+xx*(
     &        2.7804101e-21))))))         
        else if(x .lt. 8299.)then  !CORRECTED
           xx=x*1.d0-8200.d0
           yl=1.0033073+xx*(-2.0504282e-05+xx*(-4.7816989e-08))
        else if(x .lt. 8849.)then  !CORRECTED
           xx=x*1.d0-8200.d0
           yl= 0.99222898+xx*(4.6081968e-05+xx*(-3.9823487e-08+xx*(
     &       -2.2068005e-11+xx*(1.7068456e-15))))      
        else if(x .lt. 8899.)then  !CORRECTED
           xx=x*1.d0-8200.d0
           yl=0.98800874+xx*(2.7827764e-05+xx*(-1.6485680e-08))         
        else if(x .lt. 9198.)then  !CORRECTED  
           xx=x*1.d0-8200.d0
           yl=0.99442589+xx*(1.3041094e-05+xx*(-7.4344482e-09)) 
        else if(x .lt. 10000.d0)then!CORRECTED 
           xx=x*1.d0-10000.d0
           yl=0.99945349+xx*(-4.2916804e-06+xx*(-1.9395531e-08+xx*(
     &        -3.0983830e-11+xx*(-1.5374422e-14))))
        else if(x .lt. 11000.)then  !CORRECTED 
           xx=x*1.d0-10000.d0
           yl=1.0020397+xx*(-6.4429878e-06+xx*(5.0169064e-09+xx*(
     &        -9.6848571e-13)))
        else if(x .lt. 14202.)then !CORRECTED 
           xx=x*1.d0-12000.d0
           yl=1.0001166+xx*(1.2858091e-08+xx*(-3.6047814e-11+xx*(
     &       -1.0179586e-14+xx*(3.1578914e-17+xx*(-9.6304422e-21+xx*(
     &       -2.7090938e-25))))))           
        else if(x .lt. 14577.)then !CORRECTED 
           xx=x*1.d0-14250.d0
           yl=1.0001055+xx*(-6.8884596e-08+xx*(3.9872283e-10+xx*(
     &     -8.3849507e-13)))            
        else if(x .lt. 14600.)then !CORRECTED          
           yl=1.0003045
        else if(x .lt. 14996.)then !CORRECTED          
           xx=x*1.d0-14700.d0
           yl=1.0003024+xx*(1.9352738e-07+xx*(-7.1817019e-10+xx*(
     &       7.7198041e-13)))    
        else if(x .lt. 16350.)then   !CORRECTED 
           xx=x*1.d0-16000.d0
           yl=1.0003371+xx*(1.3153756e-08+xx*(-1.5271001e-10+xx*(
     &       -5.7076373e-14+xx*(2.6340205e-16+xx*(1.7442955e-19+xx*(
     &       -1.0363045e-24))))))       
        else if(x .lt. 18992)then!CORRECTED 
           xx=(x*1.d0-17000.d0)/1000.d0
           yl=1.0003486+xx*(8.2361348e-06+xx*(1.3233926e-05+xx*(
     &        3.4262205e-06+xx*(-2.5247909e-05+xx*(1.8432122e-05+xx*(
     &       -4.0307082e-06))))))           
        else if(x .lt. 22780.)then   
           xx=(x*1.d0-20000.d0)/1000.d0
           yl=1.0003811+xx*(6.2659051e-06+xx*(-2.5811144e-07+xx*(
     &        1.3344143e-06+xx*(-5.0080791e-07))))          
        else
           yl=1.d0
        end if   
	
	conhsra_RHLTE=yl

        return
	end
c------------------------------------------------------------------------------------------------------------	
        real*8 function conhsra_RHtable(x)
	
	implicit real*8 (a-h,o-z)
        include 'PARAMETER'
	real*8 xarr1(24),scaley(23),xxi
	real*8 c1(23),c2(23),c3(23),c4(23),c5(23)
	integer imin
	real*4 x
        character*100 msg

	data xarr1/ 2000.00d0, 2032.50d0, 2100.00d0,
     *   2176.50d0, 2265.60d0, 2267.30d0, 2333.50d0,
     *   2486.00d0, 2510.55d0, 2511.75d0, 2514.35d0,
     *   2516.25d0, 2518.75d0, 2660.00d0, 2731.00d0,  
     *   2952.00d0, 3065.75d0, 3646.00d0, 5000.00d0, 
     *   6500.00d0, 8000.00d0, 8203.60d0, 9500.00d0, 
     *   9999.89d0/
     
        data scaley/ 6.17666d-10, 7.96080d-10, 1.26058d-09,
     *  1.55397d-09, 1.85452d-09, 1.93155d-09, 2.08291d-09,  
     *  2.40627d-09, 2.71032d-09, 3.77803d-09, 6.76821d-09,  
     *  1.46966d-10, 6.86460d-09, 8.17417d-09, 8.87853d-09,  
     *  1.09873d-08, 1.19764d-08, 1.75357d-08, 3.50238d-08,  
     *  4.04649d-08, 4.16861d-08, 4.19025d-08, 4.12311d-08/
    
        data c1/ -28.0865, -102.935, -63.1957, -2.05568,
     * -1.78268, -21.5608, -4.93658, -2.69033, -0.373722,
     * -1.05189, -2.46891, 2.61052e6,-2.74807, -3.79666,
     * -1.87782, -3.71696, -1.27768,  47.4480,  4.66162,  
     *  8.83313, 1.04336,  3.53186,  0.710218/
     
        data c2/ 40.3659, 184.523, 115.997, 2.32518,
     * 2.45635, 37.2945, 8.72257, 4.94833, 1.09434, 
     * 1.63381, 2.75924, -4.14782d+06, 3.24314, 4.91555, 
     * 2.05934, 4.74535, 1.65965, -90.7682, -6.82316, 
     * -9.57583,  -0.0108056, -2.51752, 0.158753 /
     
        data c3/-11.2796, -80.9334, -52.2466,  0.442590, 
     * 0.0000, -15.3429, -3.11462, -1.59249,  0.00000,  
     * 0.0000, 0.000 ,1.64760d+06,-0.211922, -0.981223,
     * 0.0352113,-1.04992,-0.0862271,65.0442, 4.16988, 
     * 4.24453, 0.00000, 0.926674, -0.0205781 /
      
        data c4/0.00000, 0.00000, 0.00000, 0.00000, 
     * 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 
     * 0.00000,0.00000, 0.00000, 0.00000, 0.00000, 
     * 0.00000, 0.00000, 0.00000, -20.2286, -1.04853, 
     * -0.814127,0.00000, -0.148968, 0.00000/   
         
        data c5/0.00000, 0.00000, 0.00000, 0.00000, 
     * 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 
     * 0.00000, 0.00000, 0.00000, 0.00000, 0.00000, 
     * 0.00000,0.00000, 0.00000, 2.33008, 0.0951802, 
     * 0.0573901,0.00000, 0.00877613, 0.00000/   
     
     	if(x .lt. 2000.)then
          write(msg, *)'Lambda = ', x
          call error(KSTOP,'conhsra_RHtable','Continuum calibration valid'
     &    //         ' for wavelenths in the range 2000 to 10000 A\n'
     &    //         msg)
        end if
        
       	imin=1
	do while(x .gt. xarr1(imin+1) .and. imin .lt. 23)
	   imin=imin+1
	enddo
	
        xxi=x/2000.d0
        conhsra_RHtable=c1(imin)+xxi*(c2(imin)+xxi*(c3(imin)+xxi*(c4(imin)+xxi*c5(imin))))
        conhsra_RHtable=conhsra_RHtable*scaley(imin)

        return
        end
	
	