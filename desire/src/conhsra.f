c------------------------------------------------------------------------------------------------------------	
c conhsra(x)
c lee los coeficientes de continuum_outputSIR
c que fue escrita ejecutando continuum_allatomsSIR.pro (en /home/brc/deseos/desire2021_pruebas2/run/hsra)
c tras ejecutar el procedure continuo_hsra que llama a desire
c desire fue modificado aumentando PARAMETER y poniendo en blendscon2 continuoh=1. (linea 287)
c ERRORES
c lambda entre  500 y 1000 A err < 4%
c lambda entre 1000 y 1600 A err < 2%
c lambda entre 1600 y 2100 A err < 1%
c lambda entre 2100 y 2600 A err < 0.2%
c lambda entre 2600 y 5000 A err < 0.3%
c lambda mayor 5000 A err < 0.1%

        real*8 function conhsra(x)
	
        implicit real*8 (a-h,o-z)
        include 'PARAMETER'
        parameter (n=51)
        real*8 x1(n),xs(n),ys(n)
        real*8 c1(n),c2(n),c3(n),c4(n),c5(n)
        integer imin,i
        real*8 x,xi
        character*100 msg
        
        data iold/0/
        
               data x1/
     *     500.00000,     504.25000,     864.00000,     910.75000,    1063.50000,
     *    1100.75000,    1200.00000,    1239.75000,    1344.75000,    1399.50000,
     *    1444.50000,    1500.00000,    1520.00000,    1574.50000,    1603.00000,
     *    1621.50000,    1676.25000,    1749.75000,    1767.75000,    1890.00000,
     *    1906.75000,    1937.00000,    1940.75000,    1967.00000,    1977.75000,
     *    2100.00000,    2176.75000,    2216.50000,    2266.00000,    2267.25000,
     *    2334.00000,    2413.00000,    2438.00000,    2485.75000,    2513.50000,
     *    2518.00000,    2660.25000,    2731.25000,    3065.75000,    3644.00000,
     *    3735.00000,    3755.75000,    8113.25000,    8143.00000,    8199.00000,
     *   13770.75000,   14200.00000,   14297.75000,   14576.50000,   16414.50000,
     *   20511.00000/
 
       data xs/
     *       0.0020000,       0.0019831,       0.0011574,       0.0010980,       0.0009403,
     *       0.0009085,       0.0008333,       0.0008066,       0.0007436,       0.0007145,
     *       0.0006923,       0.0006667,       0.0006579,       0.0006351,       0.0006238,
     *       0.0006167,       0.0005966,       0.0005715,       0.0005657,       0.0005291,
     *       0.0005245,       0.0005163,       0.0005153,       0.0005084,       0.0005056,
     *       0.0004762,       0.0004594,       0.0004512,       0.0004413,       0.0004411,
     *       0.0004284,       0.0004144,       0.0004102,       0.0004023,       0.0003979,
     *       0.0003971,       0.0003759,       0.0003661,       0.0003262,       0.0002744,
     *       0.0002677,       0.0002663,       0.0001233,       0.0001228,       0.0001220,
     *       0.0000726,       0.0000704,       0.0000699,       0.0000686,       0.0000609,
     *       0.0000488/
 
       data ys/
     *   1.3259010e+06,   1.0000000e+00,   3.3636600e+10,   6.4085592e+07,   1.7539630e+09,
     *   2.6803859e+08,   1.3529480e+09,   5.2122251e+10,   2.9377449e+11,   4.2307620e+11,
     *   1.1965920e+13,   7.4632517e+12,   6.2934782e+12,   2.7724960e+12,   1.4027260e+12,
     *   4.6085519e+13,   5.5867030e+13,   6.8626770e+13,   7.1606911e+13,   8.9612731e+13,
     *   9.1683836e+13,   9.5267064e+13,   9.5657587e+13,   9.8473064e+13,   9.9519224e+13,
     *   1.0879870e+14,   1.1192480e+14,   1.1279790e+14,   1.1320810e+14,   1.1320900e+14,
     *   1.1266910e+14,   1.1069000e+14,   1.0978710e+14,   1.0776980e+14,   3.2007589e+14,
     *   3.2084050e+14,   3.4231480e+14,   3.5121800e+14,   3.8004219e+14,   5.2985210e+14,
     *   5.2359000e+14,   5.2209210e+14,   1.8633789e+14,   1.8497141e+14,   1.8359910e+14,
     *   5.8735230e+13,   5.4866811e+13,   5.4030751e+13,   5.2225359e+13,   3.8555200e+13,
     *   1.7070540e+13/
 
       data c1/
     *   4.5621500e+02,  -8.4327910e+01,  -8.5671509e+02,   1.8554232e+04,  -9.0737305e+02,
     *  -1.3181328e+03,   1.4908407e+02,  -8.9821288e+02,   1.0780035e+02,  -1.2618616e+02,
     *  -1.7570304e+02,  -7.2181013e+01,  -1.7424614e+03,   3.3094600e+02,   6.7649995e+02,
     *  -6.1068582e+00,  -8.0641802e+00,  -8.0952492e+00,   2.4190216e+00,  -8.4430046e+00,
     *  -8.4038978e+00,  -1.2708916e+00,  -8.2658339e+00,  -9.9255412e-01,  -9.2773895e+00,
     *  -6.8820120e+00,  -6.1407473e+00,  -5.6946292e+00,   9.7568308e-01,  -4.8840879e+00,
     *  -3.9455021e+00,  -3.2028046e+00,  -2.6154211e+00,  -2.0277061e+00,  -3.3621265e-01,
     *  -2.8139909e+00,  -2.4274212e+00,  -2.0680189e+00,  -3.0089625e+00,   4.4691479e-01,
     *   1.5211692e+00,   3.7365311e-01,   2.9907041e+00,   2.9874118e+00,   7.4607926e+00,
     *   6.4283594e+00,   6.0574799e+00,   5.8385243e+00,   1.3763898e+01,   1.8620717e+01,
     *   1.6610640e+01/
 
       data c2/
     *  -9.4018687e+02,   1.9059339e+02,   2.6814546e+03,  -7.3155627e+04,   2.8479258e+03,
     *   4.0459540e+03,  -3.1300256e+02,   2.8981732e+03,  -2.3108323e+02,   2.4428864e+02,
     *   3.5641915e+02,   1.5697509e+02,   5.1914639e+03,  -6.2696610e+02,  -1.3069120e+03,
     *   7.8651485e+00,   1.2750351e+01,   1.3916763e+01,  -1.7563995e+01,   1.6174866e+01,
     *   1.6252368e+01,   2.2703079e+00,   1.6277981e+01,   1.9920765e+00,   1.9783264e+01,
     *   1.4722935e+01,   1.3734521e+01,   1.3081197e+01,   2.4311543e-02,   1.1755670e+01,
     *   1.0239186e+01,   9.1402817e+00,   8.0857806e+00,   7.1230125e+00,   1.3359474e+00,
     *   6.2999314e+00,   5.8160534e+00,   5.2895212e+00,   9.2021732e+00,   1.5544372e+00,
     *  -5.2109520e-01,   2.9547832e+00,  -1.9906207e+00,  -1.9872820e+00,  -1.3574917e+01,
     *  -8.5861264e+00,  -7.8758545e+00,  -7.4293957e+00,  -3.1613924e+01,  -3.8719557e+01,
     *  -3.6153790e+01/
 
       data c3/
     *   4.8494171e+02,  -1.3941643e+02,  -2.8085969e+03,   1.0845757e+05,  -2.9901172e+03,
     *  -4.1545036e+03,   1.6491257e+02,  -3.1239741e+03,   1.2428028e+02,  -1.1710807e+02,
     *  -1.7971316e+02,  -8.3790425e+01,  -5.1372344e+03,   2.9703090e+02,   6.3142564e+02,
     *  -7.6030585e-01,  -3.6870716e+00,  -4.8221207e+00,   2.6825806e+01,  -6.7325745e+00,
     *  -6.8488069e+00,   0.0000000e+00,  -7.0124359e+00,   0.0000000e+00,  -1.0680786e+01,
     *  -6.8411604e+00,  -6.5938334e+00,  -6.3866326e+00,   0.0000000e+00,  -5.8715691e+00,
     *  -5.2935883e+00,  -4.9373264e+00,  -4.4701805e+00,  -4.0951939e+00,   0.0000000e+00,
     *  -2.4861901e+00,  -2.3887284e+00,  -2.2981720e+00,  -6.8328998e+00,  -1.0012887e+00,
     *   0.0000000e+00,  -3.6321444e+00,   0.0000000e+00,   0.0000000e+00,   1.0280640e+01,
     *   3.1577977e+00,   2.8184814e+00,   2.5909083e+00,   2.7161102e+01,   2.8128047e+01,
     *   3.0496790e+01/
 
       data c4/
     *   0.0000000e+00,   5.0581954e+01,   9.8484656e+02,  -7.1681131e+04,   1.0505605e+03,
     *   1.4276745e+03,   0.0000000e+00,   1.1250088e+03,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,   1.6892361e+03,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,  -1.0681427e+01,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   1.1747894e+00,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,   7.6555967e-02,   1.6396810e+00,   0.0000000e+00,
     *   0.0000000e+00,   1.5336150e+00,   0.0000000e+00,   0.0000000e+00,  -3.6827366e+00,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,  -8.3110523e+00,  -7.0295701e+00,
     *  -1.1650332e+01/
 
       data c5/
     *   0.0000000e+00,  -7.3274660e+00,   0.0000000e+00,   1.7825967e+04,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,  -2.2553165e-01,   0.0000000e+00,   0.0000000e+00,   5.1608003e-01,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *   1.6868295e+00/
     
        if(x .lt. 500 .or. x .gt. 21000 )then
          write(msg, *)'Lambda = ', x
          call error(KSTOP,'conhsra_table3','Continuum calibration valid'
     &    //         ' for wavelenths in the range 500 to 21000 A\n'
     &    //         msg)
        end if
        
        if(iold .ge. 1)then
           if( x .lt. x1(iold)) iold=0
        end if   
           
        i=iold   
        do while(x .gt. x1(i+1) .and. i .lt. n-1)
           i=i+1
        enddo
        iold=i
        
        xi=x*xs(i)
        if(ys(i) .gt. 2.)then
            conhsra=ys(i)*(c1(i)+xi*(c2(i)+xi*(c3(i)+xi*
     *                                           (c4(i)+xi*c5(i)))))
         else
            conhsra=exp(c1(i)+xi*(c2(i)+xi*(c3(i)+xi*
     *                                           (c4(i)+xi*c5(i)))))
        end if

        return
        end
c------------------------------------------------------------------------------------------------------------	
c conhsra_RH
c lee los coeficientes de continuum_output
c que fue escrita ejecutando continuum_allatoms.pro (en /home/brc/deseos/desire2021_pruebas2/run/hsra)
c tras correr desire modificando la rutina lines_wave poniendo
c 36        icont=1
c 37        print*,'lines_wave icont=',icont
c 38        if(icont .eq. 0)then
c ...
c 59        else
c 60           ntot=40000 !change kld & kfrec at PARAMETER accordingly (41000 can be a  good number form 1000 to 21000 with 0.5)
c 61          paso=0.5d0 !A
c 62c           waveini=500.d0
c 63          waveini=20505.5d0           
c 64          print*,'entro en el nuevo do en lines_wave con ntot=',ntot
c 65          do ipaso=1,ntot
c 66              w_air(ipaso)=waveini+(ipaso-1)*paso
c 67          end do
c 68       end if
c y en departures.f
c 389        print*,'departures 389. read_spectrum. Printing NLTE spectrum for continuum evaluation'
c 390       print*,nlam_NLTE
c 391        do ip=1,nlam_NLTE
c 392           print*,wave_NLTE_vacuum(ip),wave_NLTE(ip),SI_NLTE(ip) !valores que van a la tabla que lee continuum.pro
c 393        end do                                                   ! para generar tabla_continuo.txt
c ERRORES
c lambda entre  500 y 1000 A err < 4%
c lambda entre 1000 y 1600 A err < 2%
c lambda entre 1600 y 2100 A err < 1%
c lambda entre 2100 y 2600 A err < 0.2%
c lambda entre 2600 y 5000 A err < 0.3%
c lambda mayor 5000 A err < 0.1%

        real*8 function conhsra_RH(x)
	
        implicit real*8 (a-h,o-z)
        include 'PARAMETER'
        parameter (n=50)
        real*8 x1(n),xs(n),ys(n)
        real*8 c1(n),c2(n),c3(n),c4(n),c5(n)
        integer imin,i
        real*8 x,xi
        character*100 msg
        
        data iold/0/

        data x1/
     *     500.00000,     504.25000,     864.00000,     909.29999,    1063.50000,
     *    1100.25000,    1198.75000,    1227.50000,    1228.50000,    1232.25000,
     *    1239.25000,    1344.75000,    1444.25000,    1519.75000,    1574.50000,
     *    1603.00000,    1621.00000,    1676.25000,    1749.75000,    1767.75000,
     *    1890.00000,    1906.75000,    1937.00000,    1940.75000,    1967.00000,
     *    1977.75000,    2100.00000,    2176.75000,    2216.50000,    2265.25000,
     *    2267.25000,    2334.00000,    2438.00000,    2485.75000,    2513.25000,
     *    2518.00000,    2660.25000,    2731.25000,    3065.75000,    3646.25000,
     *    3735.00000,    3755.75000,    8113.25000,    8143.00000,    8203.75000,
     *   13770.75000,   14297.75000,   14584.25000,   16414.50000,    20511.00000/
 
        data xs/
     *       0.0020000,       0.0020000,       0.0010000,       0.0010000,       0.0010000,
     *       0.0010000,       0.0010000,       0.0010000,       0.0008000,       0.0008000,
     *       0.0008000,       0.0008000,       0.0008000,       0.0008000,       0.0008000,
     *       0.0008000,       0.0008000,       0.0008000,       0.0008000,       0.0005000,
     *       0.0005000,       0.0005000,       0.0005000,       0.0005000,       0.0005000,
     *       0.0005000,       0.0005000,       0.0005000,       0.0005000,       0.0005000,
     *       0.0005000,       0.0005000,       0.0005000,       0.0004000,       0.0004000,
     *       0.0004000,       0.0004000,       0.0004000,       0.0004000,       0.0002500,
     *       0.0002500,       0.0002000,       0.0001250,       0.0001200,       0.0001200,
     *       0.0000700,       0.0002500,       0.0002500,       0.0000500,       0.0000300/
 
       data ys/
     *   1.0000000e-19,   1.0000000e+00,   1.0000000e-13,   1.0000000e-14,   1.0000000e-14,
     *   1.0000000e-14,   1.0000000e-14,   1.0000000e-14,   1.0000000e+00,   2.5000000e-14,
     *   2.5000000e-14,   2.5000000e-14,   2.5000000e-14,   5.0000000e-14,   5.0000000e-14,
     *   5.0000000e-14,   5.0000000e-14,   2.0000000e-12,   2.0000000e-12,   2.0000000e-10,
     *   2.0000000e-10,   2.0000000e-10,   2.0000000e-10,   2.0000000e-10,   2.0000000e-10,
     *   1.0000000e-09,   1.0000000e-09,   1.0000000e-09,   1.0000000e-09,   1.0000000e-09,
     *   1.0000000e-09,   1.0000000e-09,   1.0000000e-09,   1.0000000e-09,   1.0000000e-09,
     *   1.0000000e-09,   1.0000000e-09,   1.0000000e-09,   1.0000000e-09,   2.0000000e-08,
     *   2.0000000e-08,   3.0000000e-08,   3.0000000e-08,   3.0000000e-08,   3.0000000e-08,
     *   3.0000000e-08,   3.0000000e-08,   3.0000000e-08,   3.0000000e-08,   1.0000000e-08/
 
       data c1/
     *  -3.2396732e+02,  -1.5174301e+02,  -8.7074766e+03,   1.2417924e+03,  -1.2786885e+03,
     *  -7.1294718e+02,   1.2480405e+02,   8.7697289e+00,  -2.4893779e+01,   6.9958023e+02,
     *   9.1575791e+01,  -1.4097126e+03,  -1.9587480e+03,  -1.3104346e+03,   7.3758096e+01,
     *   5.0666264e+02,   3.7959746e+03,   8.5378577e+02,  -1.8404060e+01,   4.8613298e+02,
     *  -6.8063354e+01,  -5.4881149e+01,  -7.5031995e-01,  -3.9632200e+01,  -8.2333637e+00,
     *   2.5199567e+03,  -5.6877091e+01,  -1.6974875e+01,  -2.6375495e+01,  -2.8306809e+00,
     *  -2.5612434e+01,   8.2059023e+00,   2.2610698e+01,   3.9801033e+01,  -1.2825214e+01,
     *  -3.5651140e+01,  -7.3038149e+00,   5.3511940e+02,  -1.5506040e+02,  -7.7678359e-01,
     *  -7.4259058e-01,  -3.0057904e+00,   1.3874832e+00,   1.3945070e+00,  -1.5566741e+00,
     *   3.4594789e+00,  -1.5165255e+00,  -9.2856169e+00,   5.1421589e+00,   1.3873467e+01/
 
       data c2/
     *   3.3294711e+02,   2.2127637e+02,   2.9461254e+04,  -5.2947586e+03,   3.7576680e+03,
     *   1.9464256e+03,  -2.2050703e+02,  -5.1106896e+00,  -6.5424026e+00,  -1.4110984e+03,
     *  -1.8531101e+02,   3.9314881e+03,   5.2704922e+03,   3.4084033e+03,  -1.3494302e+02,
     *  -8.0883398e+02,  -8.3637695e+03,  -1.8768711e+03,   1.8058304e+01,  -1.6652642e+03,
     *   1.4559702e+02,   1.1679884e+02,   1.8849524e+00,   8.1350277e+01,   9.9744384e+00,
     *  -7.3947688e+03,   1.0410975e+02,   2.9440924e+01,   4.5742461e+01,   4.0095757e+00,
     *   4.4123772e+01,  -1.3881758e+01,  -3.7620613e+01,  -8.1949432e+01,   1.8809600e+01,
     *   6.3955549e+01,   1.0743505e+01,  -1.3901948e+03,   3.2078412e+02,   2.0270704e+00,
     *   1.9906138e+00,   9.6829666e+00,  -2.1068710e-02,  -2.9094925e-02,   8.5905638e+00,
     *  -4.2286707e+00,   1.6054014e+00,   7.5998709e+00,  -8.5283124e+00,  -3.8473085e+01/
 
       data c3/
     *   0.0000000e+00,  -1.7078629e+02,  -3.3258907e+04,   8.4843705e+03,  -3.6930273e+03,
     *  -1.7769327e+03,   9.7899150e+01,   0.0000000e+00,   0.0000000e+00,   7.1255023e+02,
     *   9.4028300e+01,  -3.6654610e+03,  -4.7483794e+03,  -2.9514277e+03,   6.1507934e+01,
     *   3.2380112e+02,   6.1106172e+03,   1.3689895e+03,  -2.4350739e+00,   1.8943881e+03,
     *  -7.6646362e+01,  -6.0942881e+01,   0.0000000e+00,  -4.0110708e+01,   0.0000000e+00,
     *   7.2245751e+03,  -4.6490135e+01,  -1.1500647e+01,  -1.8550409e+01,   0.0000000e+00,
     *  -1.7604479e+01,   7.2851898e+00,   1.7065839e+01,   4.4530663e+01,   0.0000000e+00,
     *  -2.2273138e+01,   2.7344165e+00,   1.2046108e+03,  -2.1306628e+02,   0.0000000e+00,
     *   0.0000000e+00,  -8.5344520e+00,   0.0000000e+00,   0.0000000e+00,  -9.0306793e+00,
     *   1.9811431e+00,  -2.3559028e-01,  -1.7789363e+00,   5.4467199e+00,   4.6063796e+01/
 
       data c4/
     *   0.0000000e+00,   6.5918146e+01,   1.2529855e+04,  -6.0573848e+03,   1.2142012e+03,
     *   5.4276562e+02,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,   1.1429156e+03,   1.4330563e+03,   8.5129834e+02,   0.0000000e+00,
     *   0.0000000e+00,  -1.4781631e+03,  -3.3086798e+02,   0.0000000e+00,  -7.1466991e+02,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *  -2.3490892e+03,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,  -3.4229197e+02,   5.0569013e+01,   0.0000000e+00,
     *   0.0000000e+00,   3.6019158e+00,   0.0000000e+00,   0.0000000e+00,   4.0342195e+00,
     *   0.0000000e+00,   0.0000000e+00,   1.3281880e-01,  -1.2452405e+00,  -2.6371642e+01/
 
       data c5/
     *    0.0000000e+00,  -1.0195160e+01,   0.0000000e+00,   1.6263094e+03,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,
     *   0.0000000e+00,  -6.1431431e-01,   0.0000000e+00,   0.0000000e+00,  -6.6495945e-01,
     *   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   0.0000000e+00,   5.9054866e+00/

     	if(x .lt. 500 .or. x .gt. 41000 )then
          write(msg, *)'Lambda = ', x
          call error(KSTOP,'conhsra_RHtable3','Continuum calibration valid'
     &    //         ' for wavelenths in the range 500 to 41000 A\n'
     &    //         msg)
        end if
        
        if(iold .ge. 1)then
           if( x .lt. x1(iold)) iold=0
        end if   
           
        i=iold   
        do while(x .gt. x1(i+1) .and. i .lt. n-1)
           i=i+1
        enddo
        iold=i
        
        xi=x*xs(i)
        if(ys(i) .lt. 0.1)then
            conhsra_RH=ys(i)*(c1(i)+xi*(c2(i)+xi*(c3(i)+xi*
     *                                           (c4(i)+xi*c5(i)))))
         else
            conhsra_RH=exp(c1(i)+xi*(c2(i)+xi*(c3(i)+xi*
     *                                           (c4(i)+xi*c5(i)))))
        end if

        return
        end

